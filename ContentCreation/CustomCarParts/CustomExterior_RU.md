# Создание деталей обвеса авто

## Подготовка и создание пака

Если вы уже создали пак и хотите добавить в него детали, то этот шаг можно пропустить.

Не нужно создавать для каждой детали отдельный пак, группируйте их по типам, производителям и т.д.

Для создания пака воспользуйтесь [этим гайдом](CustomPartsPackCreation_RU.md).

# Создание модели

> [!NOTE]
> Модель можно создать в любом удобном для вас 3D софте.

Для большего удобства можно сдампить модель авто, исключив из неё часть, которую вы хотите создать, для этого выполните следующие действия:

1. перейдите в меню дампа авто: `Tools -> Car dumper -> Dump model`
2. в списке отключите части, которые вам не нужны
3. сдампите модель нажав `Dump selected parts`

![parts_model_dumper](../Images/CarParts/parts_model_dumper.png)

## Импорт моделей в Unity

Для импорта моделей в Unity вы можете перетащить нужные файлы в окно `Project` или поместить их туда вручную, через проводник.

После импорта выберите нужную модель и в окне `Inspector` перейдите на вкладку `Materials`.

Если кнопки `Extract Textures` и `Extract Materials` серые и не кликабельные, то ничего делать не нужно.

Если же они активны, то сперва извлеките текстуры, а после материалы.

![parts_unity_import_model](../Images/CarParts/parts_unity_import_model.png)

> [!IMPORTANT]
> Если вы хотите добавить возможность наложения ливрей на объект, то во вкладке `Model` включите оацию `Read/Write Enabled`.

![parts_model_import_read_write](../Images/CarParts/parts_model_import_read_write.png)

Далее создайте префаб, для этого выполните следующие действия:

1. Создайте пустой объект на сцене
2. Сбросьте его `Transform`
3. Добавьте модель в только что созданный объект
4. Сохраните префаб и удалите его со сцены
5. Выберите префаб в окне `Project` и двойным кликом перейдите в режим редактирования

![parts_create_prefab_full](../Images/CarParts/parts_create_prefab_full.gif)

После можно приступать к созданию детали.

## Создание деталей обвеса

> [!NOTE]
> В Kino Content SDK есть примеры всех деталей в папке `Examples/ExteriorParts`. Обязательно ознакомитесь с ними, для большего понимания процесса.

Доступные детали:

* Передний бампер
* Задний бампер
* Пороги
* Двери
* Зеркала
* Капот
* Багажник
* Спойлер
* Крыша
* Каркас
* Выхлоп

Все детали создаются по одному принципу. Нужно импортировать модель в Unity, создать префаб и настроить иерархию.

У некоторых деталей могут быть дополнительные компоненты, об этом [ниже](#настройка-префаба).

## Настройка префаба

> [!NOTE]
> Очень важно установить правильные имена для компонентов префаба, так как будет зависеть его отображение в игре.

Материалы детали:

* `body` - компоненты с таким названием можно будет красить и на них будет нанесена ливрея (при [правильной настройке](#настройка-uv-развертки))
* `body_nolivery` - такие компоненты можно будет только красить

![parts_body_part_hierarchy](../Images/CarParts/parts_body_part_hierarchy.png)

Дополнительные компоненты и материалы:

* `mirrors` - назовите так поверхности на **зеркалах**, которые должны иметь отражения
* `Exhaust_root` - точка крепления выхлопа, доступно только для **заднего бампера**
* `Flame_root_<N>` - точка для отстрелов, доступно только для **выхлопа**. Замените `N` на число `0-inf`, называйте точки по порядку.

![parts_mirrors_prefab](../Images/CarParts/parts_mirrors_prefab.png)
![parts_bumper_rear_prefab](../Images/CarParts/parts_bumper_rear_prefab.png)
![parts_exhaust_prefab](../Images/CarParts/parts_exhaust_prefab.png)

## Настройка UV-развертки

Для удобной настройки UV-развертки рекомендуется подготовить шаблон, для этого выполните следующие действия:

1. создайте новую ливрею в игре
2. нанесите несколько стикеров на авто, так что бы **полностью** его покрыть со всех сторон
3. сдампите получившуюся ливрею с помощью Kino: `Tools -> Car dumper -> Dump livery`

После вы получите что-то похожее на это:

![parts_190e_body_uv](../Images/CarParts/parts_190e_body_uv.png)

После чего можно приступать к настройке UV-развертки.

Создайте материал и установите ему текстуру в качестве `Base Color`

![parts_blender_set_texture](../Images/CarParts/parts_blender_set_texture.png)

Укажите путь к текстуре развёртки

![parts_blender_open_texture](../Images/CarParts/parts_blender_open_texture.png)

Перейдите в `UV Editor` и выберите только что добавленную текстуру

![parts_blender_uv_editor](../Images/CarParts/parts_blender_uv_editor.png)

Далее перейдите в `Edit Mode` и выберите нужную геометрию

![parts_blender_edit_mode_model](../Images/CarParts/parts_blender_edit_mode_model.png)

Расположите геометрию на UV-карте правильным образом

![parts_blender_uv_editor_position](../Images/CarParts/parts_blender_uv_editor_position.png)

После чего экспортируйте модель в формате `.FBX` или же `.blend` и [импортируйте](#импорт-моделей-в-unity) её в Unity